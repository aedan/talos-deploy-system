---
all:
  hosts:
    localhost:
      ansible_connection: local

      # Network configuration
      dhcp_interface: eth0                       # Change to your network interface (e.g., eno1, ens192)
      domain: pxe.local                          # Your internal domain name
      pxe_server_address: 192.168.1.10           # PXE/HTTP server IP or hostname (for serving Talos installer images)

      # DHCP range (for fallback, actual IPs come from static assignments)
      dhcp_range:
        start: 192.168.1.100
        end: 192.168.1.150

      lease_time: "12h"

      # Talos Image Factory configuration
      talos_version: v1.11.3                     # Talos Linux version
      talos_arch: amd64                          # Architecture (amd64, arm64)
      talos_extensions:                          # System extensions to include
        - siderolabs/iscsi-tools
        - siderolabs/util-linux-tools
      talos_extra_kernel_args: []                # Optional extra kernel arguments
      # talos_download_iso: true                 # Uncomment to download ISO file
      use_local_installer: true                  # Use local nginx for installer images (true) or pull from factory.talos.dev (false)

      # PXE boot configuration
      pxe_boot_image: /var/lib/tftpboot/pxelinux.0
      pxe_kernel: kernel-amd64                   # Relative to tftp_root
      pxe_initrd: initramfs-amd64.xz             # Relative to tftp_root
      pxe_boot_label: talos-install
      pxe_boot_menu_text: Install Talos Linux
      pxe_boot_params: talos.platform=metal console=tty0 init_on_alloc=1 slab_nomerge pti=on consoleblank=0 nvme_core.io_timeout=4294967295 printk.devkmsg=on selinux=1
      pxe_timeout: 30                             # Timeout in deciseconds (30 = 3 seconds)
      pxe_default_label: talos-install            # Auto-boot this label on timeout

      # DNS settings (optional)
      dns_enabled: true  # Set to false to disable DNS functions

      # Talos Cluster Configuration
      talos_cluster_name: cluster.local
      talos_cluster_endpoint: https://talos-api.example.com:6443
      talos_kubernetes_version: v1.34.1
      kubespan_enabled: false                    # Enable KubeSpan for multi-site or cross-network deployments

      # Network configuration
      network_gateway: 192.168.1.1              # Default gateway
      network_netmask: 24                        # CIDR netmask
      network_nameservers:                       # DNS servers
        - 8.8.8.8
        - 1.1.1.1
      network_mtu: 1500                          # MTU for interfaces
      network_primary_interface: eno1            # Primary network interface name
      network_ignored_interfaces: []             # Interfaces to ignore (optional, can override per-host)
        # - eno2
        # - eno3
        # - eno4

      # Longhorn configuration
      longhorn_mount_path: /var/lib/longhorn
      # This section will be populated by the script
      pxe_hosts: []
        # Example with simple networking (backward compatible):
        # - name: node01.pxe.local
        #   mac: 52:54:00:aa:bb:01
        #   ip: 192.168.1.101
        #   role: controlplane
        #   install_disk: /dev/sda
        #   ignored_interfaces:
        #     - eno2
        #     - eno3
        #
        # Example with advanced networking (Option A - detailed config):
        # - name: node02.pxe.local
        #   mac: 52:54:00:aa:bb:02
        #   role: controlplane
        #   install_disk: /dev/sda
        #   network_config:
        #     - interface: eno1
        #       addresses:
        #         - 192.168.1.102/24
        #         - 192.168.1.103/24  # Multiple IPs supported
        #       mtu: 9000
        #       routes:
        #         - network: 0.0.0.0/0
        #           gateway: 192.168.1.1
        #         - network: 10.0.0.0/8
        #           gateway: 192.168.1.254
        #     - interface: eno2
        #       addresses:
        #         - 10.0.0.102/24
        #       mtu: 1500
        #     - interface: eno1.100    # VLAN interface
        #       vlan:
        #         vlanId: 100
        #         vlanProtocol: 802.1q
        #       addresses:
        #         - 172.16.0.102/24
        #     - interface: bond0       # Bond/LAG interface
        #       bond:
        #         mode: 802.3ad
        #         lacpRate: fast
        #         interfaces:
        #           - eno3
        #           - eno4
        #       addresses:
        #         - 10.1.0.102/24
        #   ignored_interfaces:
        #     - eno5
        #     - eno6
