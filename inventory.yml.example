---
all:
  hosts:
    localhost:
      ansible_connection: local

      # Network configuration
      dhcp_interface: eth0                       # Change to your network interface (e.g., eno1, ens192)
      domain: pxe.local                          # Your internal domain name
      pxe_server_address: 192.168.1.10           # PXE/HTTP server IP or hostname (for serving Talos installer images)

      # DHCP range (for fallback, actual IPs come from static assignments)
      dhcp_range:
        start: 192.168.1.100
        end: 192.168.1.150

      lease_time: "12h"

      # Talos Image Factory configuration
      talos_version: v1.11.3                     # Talos Linux version
      talos_arch: amd64                          # Architecture (amd64, arm64)
      talos_extensions:                          # System extensions to include
        - siderolabs/iscsi-tools
        - siderolabs/util-linux-tools
      talos_extra_kernel_args: []                # Optional extra kernel arguments
      # talos_download_iso: true                 # Uncomment to download ISO file

      # PXE boot configuration
      pxe_boot_image: /var/lib/tftpboot/pxelinux.0
      pxe_kernel: kernel-amd64                   # Relative to tftp_root
      pxe_initrd: initramfs-amd64.xz             # Relative to tftp_root
      pxe_boot_label: talos-install
      pxe_boot_menu_text: Install Talos Linux
      pxe_boot_params: talos.platform=metal console=tty0 init_on_alloc=1 slab_nomerge pti=on consoleblank=0 nvme_core.io_timeout=4294967295 printk.devkmsg=on selinux=1
      pxe_timeout: 30                             # Timeout in deciseconds (30 = 3 seconds)
      pxe_default_label: talos-install            # Auto-boot this label on timeout

      # DNS settings (optional)
      dns_enabled: true  # Set to false to disable DNS functions

      # Talos Cluster Configuration
      talos_cluster_name: cluster.local
      talos_cluster_endpoint: https://talos-api.example.com:6443
      talos_kubernetes_version: v1.34.1
      kubespan_enabled: false                    # Enable KubeSpan for multi-site or cross-network deployments

      # Network configuration
      network_gateway: 192.168.1.1              # Default gateway
      network_netmask: 24                        # CIDR netmask
      network_nameservers:                       # DNS servers
        - 8.8.8.8
        - 1.1.1.1
      network_mtu: 1500                          # MTU for interfaces
      network_primary_interface: eno1            # Primary network interface name
      network_ignored_interfaces: []             # Interfaces to ignore (optional, can override per-host)
        # - eno2
        # - eno3
        # - eno4

      # Longhorn configuration
      longhorn_mount_path: /var/lib/longhorn

      # Static host reservations - only these machines will get DHCP leases
      pxe_hosts:
        # Example 1: Simple networking (most common)
        - name: node01.pxe.local
          mac: 52:54:00:12:34:56
          ip: 192.168.1.101
          role: controlplane                     # controlplane or worker
          install_disk: /dev/sda                 # Disk for Talos installation
          ignored_interfaces: [eno2, eno3]       # Optional: override network_ignored_interfaces per-host
          # Out-of-Band Management (iLO/iDRAC/Redfish)
          oob_type: ilo                          # ilo, idrac, or redfish
          oob_address: 192.168.1.201             # iLO/iDRAC IP address
          oob_username: Administrator            # OOB username
          oob_password: changeme                 # OOB password

        - name: node02.pxe.local
          mac: 52:54:00:12:34:57
          ip: 192.168.1.102
          role: controlplane
          install_disk: /dev/sda
          oob_type: ilo
          oob_address: 192.168.1.202
          oob_username: Administrator
          oob_password: changeme

        - name: node03.pxe.local
          mac: 52:54:00:12:34:58
          ip: 192.168.1.103
          role: controlplane
          install_disk: /dev/sda
          oob_type: idrac
          oob_address: 192.168.1.203
          oob_username: root
          oob_password: changeme

        - name: node04.pxe.local
          mac: 52:54:00:12:34:59
          ip: 192.168.1.104
          role: worker
          install_disk: /dev/sda
          oob_type: ilo
          oob_address: 192.168.1.204
          oob_username: Administrator
          oob_password: changeme

        - name: node05.pxe.local
          mac: 52:54:00:12:34:5a
          ip: 192.168.1.105
          role: worker
          install_disk: /dev/sda
          oob_type: idrac
          oob_address: 192.168.1.205
          oob_username: root
          oob_password: changeme

        # Example 2: Advanced networking with VLANs, Bonds, and Multiple IPs
        # Uncomment and customize if you need complex network configurations
        #
        # - name: node06.pxe.local
        #   mac: 52:54:00:12:34:5b
        #   ip: 192.168.1.106                    # Primary IP for DHCP reservation
        #   role: worker
        #   install_disk: /dev/nvme0n1
        #   network_config:                       # Advanced per-host network configuration
        #     - interface: eno1                   # Primary interface
        #       addresses:
        #         - 192.168.1.106/24
        #         - 192.168.1.107/24              # Multiple IPs on same interface
        #       mtu: 9000                         # Jumbo frames
        #       routes:
        #         - network: 0.0.0.0/0
        #           gateway: 192.168.1.1
        #         - network: 10.0.0.0/8           # Additional route
        #           gateway: 192.168.1.254
        #     - interface: eno1.100               # VLAN interface
        #       vlan:
        #         vlanId: 100
        #         vlanProtocol: 802.1q
        #       addresses:
        #         - 172.16.100.106/24
        #       mtu: 1500
        #     - interface: bond0                  # Bond/LAG interface
        #       bond:
        #         mode: 802.3ad                   # LACP
        #         lacpRate: fast
        #         interfaces:
        #           - eno2
        #           - eno3
        #       addresses:
        #         - 10.0.0.106/24
        #       mtu: 9000
        #   ignored_interfaces:                   # Unused interfaces
        #     - eno4
        #   oob_type: redfish
        #   oob_address: 192.168.1.206
        #   oob_username: admin
        #   oob_password: changeme
